<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecturer Dashboard - Signal Training School LMS</title>
    <link rel="icon" type="image/png" href="images/led.jpg">
    <link rel="shortcut icon" type="image/png" href="images/led.jpg">
    <link rel="apple-touch-icon" href="images/led.jpg">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="images/led.jpg" alt="Signal Training School Logo" class="nav-logo" onclick="window.location.href='index.html'" style="cursor: pointer;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <h1 style="display: none;">üá¨üá≠ Signal Training School LMS</h1>
            </div>
            <div class="nav-user">
                <span id="lecturerName"></span>
                <a href="exam-portal/lecturer-exam-dashboard.html" class="btn btn-primary" style="text-decoration: none; margin-right: 10px;">üìù Exam Portal</a>
                <button onclick="logout()" class="btn btn-secondary">Logout</button>
            </div>
            <!-- Hamburger Menu Button for Mobile -->
            <button class="hamburger" onclick="if(typeof toggleMobileMenu==='function'){toggleMobileMenu();}else{console.error('toggleMobileMenu not found');}" aria-label="Toggle menu" style="pointer-events: auto; touch-action: manipulation; z-index: 10001; position: relative; cursor: pointer;">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
        <!-- Mobile Menu Dropdown -->
        <div id="mobileMenu" class="mobile-menu">
            <div class="mobile-menu-content">
                <div class="mobile-menu-user" id="mobileLecturerName"></div>
                
                <!-- Navigation Links -->
                <button onclick="window.location.href='exam-portal/lecturer-exam-dashboard.html'; toggleMobileMenu();" class="btn btn-primary mobile-menu-link" style="width: 100%; padding: 14px 20px; font-size: 15px; min-height: 48px; margin: 0; border-radius: 8px; font-weight: 600; cursor: pointer; background-color: var(--primary-color); color: white; border: none; text-align: center;">
                    üìù Exam Portal
                </button>
                
                <button onclick="scrollToSection('subjectRegistration'); toggleMobileMenu();" class="btn btn-secondary mobile-menu-link">
                    üìö Subject Registration
                </button>
                
                <button onclick="scrollToSection('uploadMaterial'); toggleMobileMenu();" class="btn btn-secondary mobile-menu-link">
                    üì§ Upload Material
                </button>
                
                <button onclick="scrollToSection('uploadedMaterials'); toggleMobileMenu();" class="btn btn-info mobile-menu-link" style="background-color: #17a2b8; color: white;">
                    üìã View Materials
                </button>
                
                <button onclick="scrollToSection('analyticsDashboard'); toggleMobileMenu();" class="btn btn-secondary mobile-menu-link">
                    üìä Analytics Dashboard
                </button>
                
                <button onclick="logout(); toggleMobileMenu();" class="btn btn-danger mobile-menu-link" style="background-color: #dc3545; color: white; margin-top: 10px;">Logout</button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="dashboard-header">
            <h2>Lecturer Dashboard</h2>
            <p>Upload and manage learning materials for students</p>
        </div>
        
        <div class="dashboard-content">
            <!-- Quick Access Card -->
            <div class="card" style="background: linear-gradient(135deg, var(--primary-color) 0%, #0052a3 100%); color: white; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <div>
                        <h3 style="color: white; margin-bottom: 5px;">üìù Exam Portal</h3>
                        <p style="color: rgba(255,255,255,0.9); margin: 0;">Create and manage exams for your students</p>
                    </div>
                    <a href="exam-portal/lecturer-exam-dashboard.html" class="btn" style="background: white; color: var(--primary-color); text-decoration: none; font-weight: 600; padding: 12px 24px;">Go to Exam Portal ‚Üí</a>
                </div>
            </div>
            
            <div class="card" id="subjectRegistration">
                <h3>üìö Subject Registration</h3>
                <p style="margin-bottom: 15px; color: #666;">Register for subjects you teach to manage materials</p>
                <div class="course-registration-section">
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="lecturerClassSelect">Select Class</label>
                        <select id="lecturerClassSelect" style="max-width: 300px;" onchange="populateLecturerSubjectDropdown()">
                            <option value="">Select Class</option>
                            <optgroup label="Signals">
                                <option value="signals-basic">SIGNALS BASIC</option>
                                <option value="signals-b-iii-b-ii">SIGNALS B III ‚Äì B II</option>
                                <option value="signals-b-ii-b-i">SIGNALS B II ‚Äì B I</option>
                            </optgroup>
                            <optgroup label="Advanced Courses">
                                <option value="superintendent">SUPERINTENDENT</option>
                                <option value="pre-qualifying">PRE-QUALIFYING</option>
                            </optgroup>
                            <optgroup label="REGIMENTAL">
                                <option value="regimental-basic">REGIMENTAL BASIC</option>
                                <option value="regimental-b-iii-b-ii">REGIMENTAL B III ‚Äì B II</option>
                                <option value="regimental-b-ii-b-i">REGIMENTAL B II ‚Äì B I</option>
                            </optgroup>
                            <optgroup label="Specialized">
                                <option value="rso-rsi">RSO / RSI</option>
                                <option value="electronic-warfare-course">ELECTRONIC WARFARE COURSE</option>
                                <option value="tactical-drone-course">TACTICAL DRONE COURSE</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="lecturerSubjectSelect">Select Subject to Register</label>
                        <select id="lecturerSubjectSelect" style="max-width: 300px;">
                            <option value="">Select Class First</option>
                        </select>
                    </div>
                    <button onclick="registerLecturerForSubject()" class="btn btn-primary" style="width: auto;">Register for Subject</button>
                </div>
                <div id="lecturerRegisteredSubjects" class="registered-courses-list" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">My Registered Subjects:</h4>
                    <div id="lecturerRegisteredSubjectsList"></div>
                </div>
            </div>
            
            <div class="card" id="uploadMaterial">
                <h3>Upload Learning Material</h3>
                <form id="uploadForm" class="upload-form">
                    <div class="form-group">
                        <label for="classSelect">Class</label>
                        <select id="classSelect" name="class" required onchange="updateCoursesForLecturer()">
                            <option value="">Select Class</option>
                            <optgroup label="Signals">
                                <option value="signals-basic">SIGNALS BASIC</option>
                                <option value="signals-b-iii-b-ii">SIGNALS B III ‚Äì B II</option>
                                <option value="signals-b-ii-b-i">SIGNALS B II ‚Äì B I</option>
                            </optgroup>
                            <optgroup label="Advanced Courses">
                                <option value="superintendent">SUPERINTENDENT</option>
                                <option value="pre-qualifying">PRE-QUALIFYING</option>
                            </optgroup>
                            <optgroup label="REGIMENTAL">
                                <option value="regimental-basic">REGIMENTAL BASIC</option>
                                <option value="regimental-b-iii-b-ii">REGIMENTAL B III ‚Äì B II</option>
                                <option value="regimental-b-ii-b-i">REGIMENTAL B II ‚Äì B I</option>
                            </optgroup>
                            <optgroup label="Specialized">
                                <option value="rso-rsi">RSO / RSI</option>
                                <option value="electronic-warfare-course">ELECTRONIC WARFARE COURSE</option>
                                <option value="tactical-drone-course">TACTICAL DRONE COURSE</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="courseSelect">Course</label>
                        <select id="courseSelect" name="course" required>
                            <option value="">Select Class First</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialTitle">Material Title</label>
                        <input type="text" id="materialTitle" name="title" placeholder="e.g., Introduction to Signals" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialType">Material Type</label>
                        <select id="materialType" name="type" required onchange="handleMaterialTypeChange()">
                            <option value="">Select Type</option>
                            <option value="file">Upload File (PDF, DOC, Images, etc.)</option>
                            <option value="pdf">PDF Document (URL)</option>
                            <option value="video">Video</option>
                            <option value="link">External Link</option>
                            <option value="text">Text Content</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="fileUploadGroup" style="display: none;">
                        <label for="materialFile">Upload File</label>
                        <input type="file" id="materialFile" name="file" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.txt,.ppt,.pptx" onchange="previewFile()">
                        <small style="color: #666; font-size: 12px;">Supported: PDF, Word, Images, PowerPoint, Text files (Max 50MB - stored in Supabase Storage)</small>
                        <div id="filePreview" style="margin-top: 10px;"></div>
                    </div>
                    
                    <div class="form-group" id="contentGroup">
                        <label for="materialContent">Content/URL</label>
                        <textarea id="materialContent" name="content" rows="4" placeholder="Enter content, URL, or file path"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialCategory">Category/Module</label>
                        <input type="text" id="materialCategory" name="category" placeholder="e.g., Signals Basics, Radio Communication" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialSequence">Sequence Number</label>
                        <input type="number" id="materialSequence" name="sequence" placeholder="e.g., 1, 2, 3 (for ordering)" min="1" required>
                        <small style="color: #666; font-size: 12px;">Lower numbers appear first. Materials with same sequence are ordered by upload date.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialDescription">Description</label>
                        <textarea id="materialDescription" name="description" rows="3" placeholder="Brief description of the material"></textarea>
                    </div>
                    
                    <div class="form-actions" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary" id="submitBtn">Upload Material</button>
                        <button type="button" class="btn btn-secondary" id="cancelBtn" onclick="window.cancelEdit()" style="display: none;">Cancel</button>
                    </div>
                </form>
            </div>
            
            <div class="card" id="uploadedMaterials">
                <h3>Uploaded Materials</h3>
                <p style="margin-bottom: 15px; color: #666; font-size: 14px;">Only materials for your registered subjects are shown</p>
                <div class="filter-controls" style="margin-bottom: 20px;">
                    <select id="filterClass" onchange="loadMaterials()" style="max-width: 200px; padding: 8px; margin-right: 10px;">
                        <option value="all">All Classes</option>
                        <optgroup label="Signals">
                            <option value="signals-basic">SIGNALS BASIC</option>
                            <option value="signals-b-iii-b-ii">SIGNALS B III ‚Äì B II</option>
                            <option value="signals-b-ii-b-i">SIGNALS B II ‚Äì B I</option>
                        </optgroup>
                        <optgroup label="Advanced Courses">
                            <option value="superintendent">SUPERINTENDENT</option>
                            <option value="pre-qualifying">PRE-QUALIFYING</option>
                        </optgroup>
                        <optgroup label="Regimental">
                            <option value="regimental-basic">REGIMENTAL BASIC</option>
                            <option value="regimental-b-iii-b-ii">REGIMENTAL B III ‚Äì B II</option>
                            <option value="regimental-b-ii-b-i">REGIMENTAL B II ‚Äì B I</option>
                        </optgroup>
                        <optgroup label="Specialized">
                            <option value="rso-rsi">RSO / RSI</option>
                            <option value="electronic-warfare-course">ELECTRONIC WARFARE COURSE</option>
                            <option value="tactical-drone-course">TACTICAL DRONE COURSE</option>
                        </optgroup>
                    </select>
                    <select id="filterCategory" onchange="loadMaterials()" style="max-width: 200px; padding: 8px;">
                        <option value="all">All Categories</option>
                    </select>
                </div>
                <div id="materialsList" class="materials-list">
                    <p class="empty-state">No materials uploaded yet</p>
                </div>
            </div>
            
            <div class="card" id="analyticsDashboard">
                <h3>üìä Analytics Dashboard</h3>
                <div class="analytics-tabs" style="margin-bottom: 20px;">
                    <button class="tab-btn active" onclick="showAnalytics('overview')">Overview</button>
                    <button class="tab-btn" onclick="showAnalytics('class-progress')">Class Progress</button>
                    <button class="tab-btn" onclick="showAnalytics('material-stats')">Material Statistics</button>
                </div>
                
                <div id="analyticsContent">
                    <div id="overviewTab" class="analytics-tab active">
                        <div class="analytics-grid">
                            <div class="analytics-card">
                                <h4>Total Materials</h4>
                                <div class="analytics-value" id="totalMaterialsCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h4>Total Students</h4>
                                <div class="analytics-value" id="totalStudentsCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h4>Overall Completion Rate</h4>
                                <div class="analytics-value" id="overallCompletion">0%</div>
                            </div>
                            <div class="analytics-card">
                                <h4>Active Classes</h4>
                                <div class="analytics-value" id="activeClassesCount">0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="classProgressTab" class="analytics-tab" style="display: none;">
                        <div id="classProgressContent"></div>
                    </div>
                    
                    <div id="materialStatsTab" class="analytics-tab" style="display: none;">
                        <div id="materialStatsContent"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Supabase JS Library -->
    <!-- Security Utilities (must load first) -->
    <script src="js/security.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/supabase-helpers.js"></script>
    <script src="js/app.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/system-optimizer.js"></script>
    <script src="js/performance-optimizer.js"></script>
    <script src="js/mobile.js"></script>
    <script src="js/mobile-nav-force-fix.js"></script>
    <script src="js/mobile-menu-fix.js"></script>
    <script src="js/mobile-menu-visibility-fix.js"></script>
    <script src="js/hamburger-debug.js"></script>
    <script src="js/lecturer-hamburger-fix.js"></script>
    <script src="js/lecturer.js"></script>
    <script src="js/modal.js"></script>
    
    <!-- Modal for Messages -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="modal-icon" id="modalIcon"></div>
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button id="modalButton" class="btn btn-primary">OK</button>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2026 Signal Training School. All rights reserved.</p>
        <p style="font-size: 16px; font-weight: 600; margin: 10px 0; opacity: 1 !important;">Developed and Powered by <strong style="color: #ffffff; font-size: 1.2em; font-weight: 700; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">Frank Kojo Dogbe</strong> | Co-developed by Solomon A. Nortey</p>
        <p style="margin-top: 10px;"><a href="#help" onclick="showHelpModal(); return false;" style="color: white; text-decoration: underline; cursor: pointer;">üìû Need Help?</a></p>
    </footer>
    
    <!-- Help Modal -->
    <div id="helpModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeHelpModal()">&times;</span>
            <h2>üìû Need Help?</h2>
            <div style="text-align: left; margin-top: 20px;">
                <h3>Common Issues:</h3>
                <ul style="line-height: 1.8;">
                    <li><strong>Upload Issues:</strong> Check file size (max 50MB), ensure file format is supported (PDF, Word, Images, PowerPoint, Text)</li>
                    <li><strong>Materials Not Showing:</strong> Verify you're registered for the subject and check class filters</li>
                    <li><strong>Browser Issues:</strong> Try clearing cache or using a different browser</li>
                    <li><strong>Console Errors:</strong> Press F12 to open developer tools and check the Console tab</li>
                </ul>
                <h3 style="margin-top: 20px;">Technical Support:</h3>
                <p>If you experience any issues, please seek support from Signal Training School.</p>
            </div>
            <button onclick="closeHelpModal()" class="btn btn-primary" style="margin-top: 20px;">Close</button>
        </div>
    </div>
    
    <script>
    function showHelpModal() {
        document.getElementById('helpModal').style.display = 'flex';
    }
    function closeHelpModal() {
        document.getElementById('helpModal').style.display = 'none';
    }
    window.onclick = function(event) {
        const modal = document.getElementById('helpModal');
        if (event.target == modal) {
            closeHelpModal();
        }
    }
    
    // Scroll to section function for mobile menu navigation
    function scrollToSection(sectionId) {
        const section = document.getElementById(sectionId);
        if (section) {
            section.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            // Try to find by class or other identifier
            const element = document.querySelector(`.${sectionId}`) || 
                           document.querySelector(`[data-section="${sectionId}"]`);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
    }
    
    // Make functions globally accessible
    window.scrollToSection = scrollToSection;
    </script>
</body>
</html>

