<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lecturer Dashboard - Signal Training School LMS</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <button class="hamburger" onclick="toggleMobileMenu()" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
                <img src="images/logo.png" alt="Signal Training School Logo" class="nav-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <h1 style="display: none;">ðŸ‡¬ðŸ‡­ Signal Training School LMS</h1>
            </div>
            <div class="nav-user">
                <span id="lecturerName"></span>
                <button onclick="logout()" class="btn btn-secondary">Logout</button>
            </div>
        </div>
        <div class="mobile-menu" id="mobileMenu">
            <div class="mobile-menu-content">
                <div class="mobile-menu-user">
                    <strong id="mobileLecturerName"></strong>
                </div>
                <button onclick="logout()" class="btn btn-secondary mobile-logout">Logout</button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="dashboard-header">
            <h2>Lecturer Dashboard</h2>
            <p>Upload and manage learning materials for students</p>
        </div>
        
        <div class="dashboard-content">
            <div class="card">
                <h3>ðŸ“š Subject Registration</h3>
                <p style="margin-bottom: 15px; color: #666;">Register for subjects you teach to manage materials</p>
                <div class="course-registration-section">
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="lecturerClassSelect">Select Class</label>
                        <select id="lecturerClassSelect" style="max-width: 300px;" onchange="populateLecturerSubjectDropdown()">
                            <option value="">Select Class</option>
                            <optgroup label="Signals">
                                <option value="signals-basic">SIGNALS BASIC</option>
                                <option value="signals-b-iii-b-ii">SIGNALS B III â€“ B II</option>
                                <option value="signals-b-ii-b-i">SIGNALS B II â€“ B I</option>
                            </optgroup>
                            <optgroup label="Advanced Courses">
                                <option value="superintendent">SUPERINTENDENT</option>
                                <option value="pre-qualifying">PRE-QUALIFYING</option>
                            </optgroup>
                            <optgroup label="Regimental">
                                <option value="regimental-basic">REGIMENTAL BASIC</option>
                                <option value="regimental-b-iii-b-ii">REGIMENTAL B III â€“ B II</option>
                                <option value="regimental-b-ii-b-i">REGIMENTAL B II â€“ B I</option>
                            </optgroup>
                            <optgroup label="Specialized">
                                <option value="rso-rsi">RSO / RSI</option>
                                <option value="electronic-warfare-course">ELECTRONIC WARFARE COURSE</option>
                                <option value="tactical-drone-course">TACTICAL DRONE COURSE</option>
                            </optgroup>
                        </select>
                    </div>
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="lecturerSubjectSelect">Select Subject to Register</label>
                        <select id="lecturerSubjectSelect" style="max-width: 300px;">
                            <option value="">Select Class First</option>
                        </select>
                    </div>
                    <button onclick="registerLecturerForSubject()" class="btn btn-primary" style="width: auto;">Register for Subject</button>
                </div>
                <div id="lecturerRegisteredSubjects" class="registered-courses-list" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">My Registered Subjects:</h4>
                    <div id="lecturerRegisteredSubjectsList"></div>
                </div>
            </div>
            
            <div class="card">
                <h3>Upload Learning Material</h3>
                <form id="uploadForm" class="upload-form">
                    <div class="form-group">
                        <label for="classSelect">Class</label>
                        <select id="classSelect" name="class" required onchange="updateCoursesForLecturer()">
                            <option value="">Select Class</option>
                            <optgroup label="Signals">
                                <option value="signals-basic">SIGNALS BASIC</option>
                                <option value="signals-b-iii-b-ii">SIGNALS B III â€“ B II</option>
                                <option value="signals-b-ii-b-i">SIGNALS B II â€“ B I</option>
                            </optgroup>
                            <optgroup label="Advanced Courses">
                                <option value="superintendent">SUPERINTENDENT</option>
                                <option value="pre-qualifying">PRE-QUALIFYING</option>
                            </optgroup>
                            <optgroup label="Regimental">
                                <option value="regimental-basic">REGIMENTAL BASIC</option>
                                <option value="regimental-b-iii-b-ii">REGIMENTAL B III â€“ B II</option>
                                <option value="regimental-b-ii-b-i">REGIMENTAL B II â€“ B I</option>
                            </optgroup>
                            <optgroup label="Specialized">
                                <option value="rso-rsi">RSO / RSI</option>
                                <option value="electronic-warfare-course">ELECTRONIC WARFARE COURSE</option>
                                <option value="tactical-drone-course">TACTICAL DRONE COURSE</option>
                            </optgroup>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="courseSelect">Course</label>
                        <select id="courseSelect" name="course" required>
                            <option value="">Select Class First</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialTitle">Material Title</label>
                        <input type="text" id="materialTitle" name="title" placeholder="e.g., Introduction to Signals" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialType">Material Type</label>
                        <select id="materialType" name="type" required onchange="handleMaterialTypeChange()">
                            <option value="">Select Type</option>
                            <option value="file">Upload File (PDF, DOC, Images, etc.)</option>
                            <option value="pdf">PDF Document (URL)</option>
                            <option value="video">Video</option>
                            <option value="link">External Link</option>
                            <option value="text">Text Content</option>
                        </select>
                    </div>
                    
                    <div class="form-group" id="fileUploadGroup" style="display: none;">
                        <label for="materialFile">Upload File</label>
                        <input type="file" id="materialFile" name="file" accept=".pdf,.doc,.docx,.jpg,.jpeg,.png,.gif,.txt,.ppt,.pptx" onchange="previewFile()">
                        <small style="color: #666; font-size: 12px;">Supported: PDF, Word, Images, PowerPoint, Text files (Max 50MB - stored in Supabase Storage)</small>
                        <div id="filePreview" style="margin-top: 10px;"></div>
                    </div>
                    
                    <div class="form-group" id="contentGroup">
                        <label for="materialContent">Content/URL</label>
                        <textarea id="materialContent" name="content" rows="4" placeholder="Enter content, URL, or file path"></textarea>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialCategory">Category/Module</label>
                        <input type="text" id="materialCategory" name="category" placeholder="e.g., Signals Basics, Radio Communication" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialSequence">Sequence Number</label>
                        <input type="number" id="materialSequence" name="sequence" placeholder="e.g., 1, 2, 3 (for ordering)" min="1" required>
                        <small style="color: #666; font-size: 12px;">Lower numbers appear first. Materials with same sequence are ordered by upload date.</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="materialDescription">Description</label>
                        <textarea id="materialDescription" name="description" rows="3" placeholder="Brief description of the material"></textarea>
                    </div>
                    
                    <div class="form-actions" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-primary" id="submitBtn">Upload Material</button>
                        <button type="button" class="btn btn-secondary" id="cancelBtn" onclick="window.cancelEdit()" style="display: none;">Cancel</button>
                    </div>
                </form>
            </div>
            
            <div class="card">
                <h3>Uploaded Materials</h3>
                <p style="margin-bottom: 15px; color: #666; font-size: 14px;">Only materials for your registered subjects are shown</p>
                <div class="filter-controls" style="margin-bottom: 20px;">
                    <select id="filterClass" onchange="loadMaterials()" style="max-width: 200px; padding: 8px; margin-right: 10px;">
                        <option value="all">All Classes</option>
                        <optgroup label="Signals">
                            <option value="signals-basic">SIGNALS BASIC</option>
                            <option value="signals-b-iii-b-ii">SIGNALS B III â€“ B II</option>
                            <option value="signals-b-ii-b-i">SIGNALS B II â€“ B I</option>
                        </optgroup>
                        <optgroup label="Advanced Courses">
                            <option value="superintendent">SUPERINTENDENT</option>
                            <option value="pre-qualifying">PRE-QUALIFYING</option>
                        </optgroup>
                        <optgroup label="Regimental">
                            <option value="regimental-basic">REGIMENTAL BASIC</option>
                            <option value="regimental-b-iii-b-ii">REGIMENTAL B III â€“ B II</option>
                            <option value="regimental-b-ii-b-i">REGIMENTAL B II â€“ B I</option>
                        </optgroup>
                        <optgroup label="Specialized">
                            <option value="rso-rsi">RSO / RSI</option>
                            <option value="electronic-warfare-course">ELECTRONIC WARFARE COURSE</option>
                            <option value="tactical-drone-course">TACTICAL DRONE COURSE</option>
                        </optgroup>
                    </select>
                    <select id="filterCategory" onchange="loadMaterials()" style="max-width: 200px; padding: 8px;">
                        <option value="all">All Categories</option>
                    </select>
                </div>
                <div id="materialsList" class="materials-list">
                    <p class="empty-state">No materials uploaded yet</p>
                </div>
            </div>
            
            <div class="card">
                <h3>ðŸ“Š Analytics Dashboard</h3>
                <div class="analytics-tabs" style="margin-bottom: 20px;">
                    <button class="tab-btn active" onclick="showAnalytics('overview')">Overview</button>
                    <button class="tab-btn" onclick="showAnalytics('class-progress')">Class Progress</button>
                    <button class="tab-btn" onclick="showAnalytics('material-stats')">Material Statistics</button>
                </div>
                
                <div id="analyticsContent">
                    <div id="overviewTab" class="analytics-tab active">
                        <div class="analytics-grid">
                            <div class="analytics-card">
                                <h4>Total Materials</h4>
                                <div class="analytics-value" id="totalMaterialsCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h4>Total Students</h4>
                                <div class="analytics-value" id="totalStudentsCount">0</div>
                            </div>
                            <div class="analytics-card">
                                <h4>Overall Completion Rate</h4>
                                <div class="analytics-value" id="overallCompletion">0%</div>
                            </div>
                            <div class="analytics-card">
                                <h4>Active Classes</h4>
                                <div class="analytics-value" id="activeClassesCount">0</div>
                            </div>
                        </div>
                    </div>
                    
                    <div id="classProgressTab" class="analytics-tab" style="display: none;">
                        <div id="classProgressContent"></div>
                    </div>
                    
                    <div id="materialStatsTab" class="analytics-tab" style="display: none;">
                        <div id="materialStatsContent"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Supabase JS Library -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/supabase-helpers.js"></script>
    <script src="js/app.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/mobile.js"></script>
    <script src="js/lecturer.js"></script>
</body>
</html>

