<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Portal - Signal Training School LMS</title>
    <link rel="icon" type="image/png" href="images/led.jpg">
    <link rel="shortcut icon" type="image/png" href="images/led.jpg">
    <link rel="apple-touch-icon" href="images/led.jpg">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <img src="images/led.jpg" alt="Signal Training School Logo" class="nav-logo" onclick="window.location.href='index.html'" style="cursor: pointer;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
                <h1 style="display: none;">üá¨üá≠ Signal Training School LMS</h1>
            </div>
            <div class="nav-user">
                <span id="studentName"></span>
                <a href="exam-portal/student-exam-portal.html" class="btn btn-primary" style="text-decoration: none; margin-right: 10px;">üìù Exam Portal</a>
                <button onclick="logout()" class="btn btn-secondary">Logout</button>
            </div>
        </div>
    </nav>
    
    <div class="container">
        <div class="dashboard-header">
            <h2>Student Learning Portal</h2>
            <p id="studentInfo">Welcome to your learning dashboard</p>
        </div>
        
        <div class="dashboard-content">
            <!-- Quick Access Card -->
            <div class="card" style="background: linear-gradient(135deg, var(--primary-color) 0%, #0052a3 100%); color: white; margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <div>
                        <h3 style="color: white; margin-bottom: 5px;">üìù Exam Portal</h3>
                        <p style="color: rgba(255,255,255,0.9); margin: 0;">Take exams and view your results</p>
                    </div>
                    <a href="exam-portal/student-exam-portal.html" class="btn" style="background: white; color: var(--primary-color); text-decoration: none; font-weight: 600; padding: 12px 24px;">Go to Exam Portal ‚Üí</a>
                </div>
            </div>
        </div>
        
        <!-- Progress Dashboard Tabs -->
        <div class="card" style="margin-bottom: 20px;">
            <div style="display: flex; gap: 10px; border-bottom: 2px solid #e0e0e0; margin-bottom: 20px;">
                <button id="materialsProgressTab" onclick="showProgressTab('materials')" class="btn btn-primary" style="border-radius: 0; border-bottom: 3px solid var(--primary-color);">
                    üìö Materials Progress
                </button>
                <button id="examProgressTab" onclick="showProgressTab('exams')" class="btn btn-secondary" style="border-radius: 0;">
                    üìù Exam Performance
                </button>
            </div>
            
            <!-- Materials Progress Section -->
            <div id="materialsProgressSection">
                <h3>Learning Progress</h3>
                <div id="progressStats" class="progress-stats">
                    <div class="stat-item">
                        <span class="stat-value" id="totalMaterials">0</span>
                        <span class="stat-label">Total Materials</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="completedMaterials">0</span>
                        <span class="stat-label">Completed</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value" id="progressPercentage">0%</span>
                        <span class="stat-label">Progress</span>
                    </div>
                </div>
            </div>
            
            <!-- Exam Progress Dashboard Section -->
            <div id="examProgressSection" style="display: none;">
                <h3>Exam Performance Dashboard</h3>
                <div id="progressDashboard">
                    <p>Loading progress data...</p>
                </div>
            </div>
        </div>
        
        <div class="dashboard-content">
            <div class="card">
                <h3>üìö Subject Registration</h3>
                <p style="margin-bottom: 15px; color: #666;">Register for subjects to access learning materials</p>
                <div class="course-registration-section">
                    <div class="form-group" style="margin-bottom: 15px;">
                        <label for="registerCourseSelect">Select Subject to Register</label>
                        <select id="registerCourseSelect" style="max-width: 300px;">
                            <option value="">Select a subject</option>
                        </select>
                    </div>
                    <button onclick="registerForCourse()" class="btn btn-primary" style="width: auto;">Register for Subject</button>
                </div>
                <div id="registeredCourses" class="registered-courses-list" style="margin-top: 20px;">
                    <h4 style="margin-bottom: 10px;">My Registered Subjects:</h4>
                    <div id="registeredCoursesList"></div>
                </div>
            </div>
            
            <div class="card">
                <h3>Learning Materials</h3>
                <div id="noCoursesMessage" class="empty-state" style="display: none;">
                    <p>You haven't registered for any subjects yet. Please register for a subject above to view materials.</p>
                </div>
                <div id="materialsSection" style="display: none;">
                    <div class="course-filter" style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                        <select id="courseFilter" style="max-width: 200px;">
                            <option value="all">All My Courses</option>
                        </select>
                        <select id="categoryFilter" style="max-width: 200px;">
                            <option value="all">All Categories</option>
                        </select>
                    </div>
                    
                    <div id="materialsList" class="materials-list">
                        <p class="empty-state">No learning materials available yet</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div id="materialModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeMaterialModal()">&times;</span>
            <h2 id="modalTitle"></h2>
            <div id="modalBody"></div>
            <div class="modal-actions">
                <button onclick="markAsCompleted()" class="btn btn-success" id="completeBtn">Mark as Completed</button>
                <button onclick="closeMaterialModal()" class="btn btn-secondary">Close</button>
            </div>
        </div>
    </div>
    
    <!-- Supabase JS Library -->
    <!-- Security Utilities (must load first) -->
    <script src="js/security.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/supabase-helpers.js"></script>
    <script src="js/app.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/mobile.js"></script>
    <script src="js/student.js"></script>
    <script src="js/modal.js"></script>
    <!-- Performance Utilities -->
    <script src="js/performance.js"></script>
    <!-- Error Monitoring -->
    <script src="js/error-monitoring.js"></script>
    <!-- Student Progress Dashboard -->
    <script src="exam-portal/js/student-progress-dashboard.js"></script>
    <script>
        // Initialize error monitoring
        if (typeof ErrorMonitoring !== 'undefined') {
            ErrorMonitoring.init({
                environment: window.location.hostname === 'localhost' ? 'development' : 'production'
            });
            
            const currentUser = getCurrentUser();
            if (currentUser) {
                ErrorMonitoring.setUser(currentUser);
            }
        }
        
        // Initialize performance monitoring
        if (typeof PerformanceUtils !== 'undefined') {
            PerformanceUtils.monitorPerformance();
        }
        
        // Progress dashboard tab switching
        function showProgressTab(tab) {
            const materialsSection = document.getElementById('materialsProgressSection');
            const examSection = document.getElementById('examProgressSection');
            const materialsTab = document.getElementById('materialsProgressTab');
            const examTab = document.getElementById('examProgressTab');
            
            if (tab === 'exams') {
                materialsSection.style.display = 'none';
                examSection.style.display = 'block';
                materialsTab.classList.remove('btn-primary');
                materialsTab.classList.add('btn-secondary');
                materialsTab.style.borderBottom = 'none';
                examTab.classList.remove('btn-secondary');
                examTab.classList.add('btn-primary');
                examTab.style.borderBottom = '3px solid var(--primary-color)';
                
                // Load exam progress data
                if (typeof initializeStudentProgressDashboard !== 'undefined') {
                    initializeStudentProgressDashboard();
                }
            } else {
                materialsSection.style.display = 'block';
                examSection.style.display = 'none';
                examTab.classList.remove('btn-primary');
                examTab.classList.add('btn-secondary');
                examTab.style.borderBottom = 'none';
                materialsTab.classList.remove('btn-secondary');
                materialsTab.classList.add('btn-primary');
                materialsTab.style.borderBottom = '3px solid var(--primary-color)';
            }
        }
    </script>
    
    <!-- Modal for Messages -->
    <div id="messageModal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="modal-icon" id="modalIcon"></div>
            <h3 id="modalTitle"></h3>
            <p id="modalMessage"></p>
            <button id="modalButton" class="btn btn-primary">OK</button>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="footer">
        <p>&copy; 2026 Signal Training School. All rights reserved.</p>
        <p style="font-size: 16px; font-weight: 600; margin: 10px 0; opacity: 1 !important;">Developed and Powered by <strong style="color: #ffffff; font-size: 1.2em; font-weight: 700; text-shadow: 1px 1px 2px rgba(0,0,0,0.3);">Frank Kojo Dogbe</strong> | Co-developed by Solomon A. Nortey</p>
        <p style="margin-top: 10px;"><a href="#help" onclick="showHelpModal(); return false;" style="color: white; text-decoration: underline; cursor: pointer;">üìû Need Help?</a></p>
    </footer>
    
    <!-- Help Modal -->
    <div id="helpModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="modal-close" onclick="closeHelpModal()">&times;</span>
            <h2>üìû Need Help?</h2>
            <div style="text-align: left; margin-top: 20px;">
                <h3>Common Issues:</h3>
                <ul style="line-height: 1.8;">
                    <li><strong>Materials Not Loading:</strong> Check you're registered for the subject and verify your class filter</li>
                    <li><strong>Progress Not Saving:</strong> Ensure you click "Mark as Completed" after viewing materials</li>
                    <li><strong>Download Issues:</strong> Check your internet connection and browser download settings</li>
                    <li><strong>Console Errors:</strong> Press F12 to open developer tools and check the Console tab</li>
                </ul>
                <h3 style="margin-top: 20px;">Technical Support:</h3>
                <p>If you experience any issues, please seek support from Signal Training School.</p>
            </div>
            <button onclick="closeHelpModal()" class="btn btn-primary" style="margin-top: 20px;">Close</button>
        </div>
    </div>
    
    <script>
    function showHelpModal() {
        document.getElementById('helpModal').style.display = 'flex';
    }
    function closeHelpModal() {
        document.getElementById('helpModal').style.display = 'none';
    }
    window.onclick = function(event) {
        const modal = document.getElementById('helpModal');
        if (event.target == modal) {
            closeHelpModal();
        }
    }
    </script>
</body>
</html>

